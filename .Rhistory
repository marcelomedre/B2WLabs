predictedSpam[predictionModel$fitted > 0.5 ] = "spam"
table(predictedSpam, testSpam$type)
(61+449)/(1346 + 61 + 458 + 449)
(61+458)/(1346 + 61 + 458 + 449)
595/548
567/595
567/549
567/548
502/513
1-0.978
481/502
481/513
setwd("C:/Users/Marcelo/Desktop/Data/B2WLabs/")
rm(list = ls())
rmse <- function(error)
{
sqrt(mean(error^2))
}
sales <- read.csv("sales.csv", header = TRUE, stringsAsFactors = FALSE)
comp_prices <- read.csv("comp_prices.csv", header = TRUE, stringsAsFactors = FALSE)
sales$DATE_ORDER <- as.Date(sales$DATE_ORDER)
sales$day <- as.numeric(as.factor(wday(sales$DATE_ORDER)))
library(lubridate)
library(ggplot2)
library(plyr)
library(data.table)
library(dplyr)
sales$day <- as.numeric(as.factor(wday(sales$DATE_ORDER)))
sales$month <- as.numeric(as.factor(month(sales$DATE_ORDER)))
View(sales)
sales$PROD_PRICE <- sales$REVENUE/sales$QTY_ORDER
View(comp_prices)
Price_by_weekday_month <- sales %>%
group_by(Month, PROD_ID) %>%
#filter(PROD_ID == "P1") %>%
summarise(QTY_ORDER = sum(QTY_ORDER),
REVENUE = sum (REVENUE)) %>%
mutate(Price = REVENUE/QTY_ORDER)
Price_by_weekday_month <- sales %>%
group_by(month, PROD_ID) %>%
#filter(PROD_ID == "P1") %>%
summarise(QTY_ORDER = sum(QTY_ORDER),
REVENUE = sum (REVENUE)) %>%
mutate(Price = REVENUE/QTY_ORDER)
View(Price_by_weekday_month)
Price_by_weekday_month <- sales %>%
group_by(month, day, PROD_ID) %>%
#filter(PROD_ID == "P1") %>%
summarise(QTY_ORDER = sum(QTY_ORDER),
REVENUE = sum (REVENUE)) %>%
mutate(Price = REVENUE/QTY_ORDER)
P1_Price_by_weekday_month <- sales %>%
group_by(month, day, PROD_ID) %>%
filter(PROD_ID == "P1") %>%
summarise(QTY_ORDER = sum(QTY_ORDER),
REVENUE = sum (REVENUE)) %>%
mutate(Price = REVENUE/QTY_ORDER)
View(P1_Price_by_weekday_month)
ggplot(P1_Price_by_weekday_month, aes(x = Price, y = QTY_ORDER))+
geom_point()
ggplot(P1_Price_by_weekday_month, aes(x = Month, y = QTY_ORDER))+
geom_point()
ggplot(P1_Price_by_weekday_month, aes(x = month, y = QTY_ORDER))+
geom_point()
ggplot(P1_Price_by_weekday_month, aes(x = month, y = QTY_ORDER))+
geom_point()+
geom_line(mapping = aes(class = day))
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_point()+
geom_line(mapping = aes(class = month))
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_point()+
geom_line(mapping = aes(color = month))
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_point(mapping = aes(color = month)
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_point(mapping = aes(color = month))
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_line(mapping = aes(color = month))
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_point(mapping = aes(color = month))
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_boxplot(mapping = aes(color = month))
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_boxplot()
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_boxplot(mapping = aes(group = day))
?facets
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_boxplot(mapping = aes(group = day))+
facet_grid(month ~. )
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_boxplot(mapping = aes(group = day))+
facet_grid(~month)
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_boxplot(mapping = aes(group = day))
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER, color = month))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day))
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER, color = month))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day))+
geom_line(data = P1_Price_by_weekday_month, aes(group = day))
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER, color = month))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day))+
geom_line(data = P1_Price_by_weekday_month, aes(group = month))
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day))+
geom_line(data = P1_Price_by_weekday_month, aes(group = month))
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER, color = month))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day))+
geom_line(data = P1_Price_by_weekday_month, aes(group = month))
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER, color = month))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day))+
geom_line(data = P1_Price_by_weekday_month, aes(group = month))+
theme()
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER, color = month))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day))+
geom_line(data = P1_Price_by_weekday_month, aes(group = month))+
geom_smooth()+
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER, color = month))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day))+
geom_line(data = P1_Price_by_weekday_month, aes(group = month))+
geom_smooth()
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER, color = factor(month)))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day))+
geom_line(data = P1_Price_by_weekday_month, aes(group = month))+
geom_smooth()
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER, color = factor(month)))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day))+
geom_line(data = P1_Price_by_weekday_month, aes(group = month))
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER, color = factor(month)))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day), size = 3)+
geom_line(data = P1_Price_by_weekday_month, aes(group = month))
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER, color = factor(month)))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day), size = 3)+
geom_line(data = P1_Price_by_weekday_month, aes(group = month))+
xlab("Dia da Semana")+
ylab("Quantidade vendida Produto 1")
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER, color = factor(month)))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day), size = 3)+
geom_smooth()+
geom_line(data = P1_Price_by_weekday_month, aes(group = month))+
xlab("Dia da Semana")+
ylab("Quantidade vendida Produto 1")
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day), size = 3)+
geom_smooth()+
geom_line(data = P1_Price_by_weekday_month, aes(group = month))+
xlab("Dia da Semana")+
ylab("Quantidade vendida Produto 1")
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day), size = 3)+
geom_smooth()+
geom_line(data = P1_Price_by_weekday_month, aes(group = month, color = factor(month)))+
xlab("Dia da Semana")+
ylab("Quantidade vendida Produto 1")
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day, col = month), size = 3)+
geom_smooth()+
geom_line(data = P1_Price_by_weekday_month, aes(group = month, color = factor(month)))+
xlab("Dia da Semana")+
ylab("Quantidade vendida Produto 1")
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day, color = month), size = 3)+
geom_smooth()+
geom_line(data = P1_Price_by_weekday_month, aes(group = month, color = factor(month)))+
xlab("Dia da Semana")+
ylab("Quantidade vendida Produto 1")
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day, color = factor(month)), size = 3)+
geom_smooth()+
geom_line(data = P1_Price_by_weekday_month, aes(group = month))+
xlab("Dia da Semana")+
ylab("Quantidade vendida Produto 1")
ggplot(P1_Price_by_weekday_month, aes(x = day, y = QTY_ORDER))+
geom_point(data = P1_Price_by_weekday_month, aes(group = day, color = factor(month)), size = 3)+
geom_smooth()+
geom_line(data = P1_Price_by_weekday_month, aes(group = month, color = factor(month)))+
xlab("Dia da Semana")+
ylab("Quantidade vendida Produto 1")
P1_by_month <- sales %>%
group_by(month, PROD_ID) %>%
filter(PROD_ID == "P1") %>%
summarise(QTY_ORDER = sum(QTY_ORDER),
REVENUE = sum (REVENUE)) %>%
mutate(Price = REVENUE/QTY_ORDER)
View(P1_by_month)
ggplot(P1_by_month, aes(x = month, y = QTY_ORDER, color = Price))+
geom_point(size = 3)+
geom_smooth()+
xlab("Mês")+
ylab("Quantidade vendida Produto 1")
ggplot(P1_by_month, aes(x = month, y = QTY_ORDER, color = Price))+
geom_point(size = 3)+
xlab("Mês")+
ylab("Quantidade vendida Produto 1")
ggplot(P1_by_month, aes(x = month, y = QTY_ORDER, color = factor(Price)))+
geom_point(size = 3)+
xlab("Mês")+
ylab("Quantidade vendida Produto 1")
ggplot(P1_by_month, aes(x = Price, y = QTY_ORDER, color = factor(month)))+
geom_point(size = 3)+
xlab("Mês")+
ylab("Quantidade vendida Produto 1")
ggplot(P1_by_month, aes(x = month, y = QTY_ORDER, color = Price))+
geom_point(size = 3)+
xlab("Mês")+
ylab("Quantidade vendida Produto 1")
ggplot(P1_by_month, aes(x = month, y = QTY_ORDER, color = Price))+
geom_point(size = 3)+
geom_smooth()+
xlab("Mês")+
ylab("Quantidade vendida Produto 1")
ggplot(P1_by_month, aes(x = month, y = QTY_ORDER, color = Price))+
geom_point(size = 3)+
xlab("Mês")+
ylab("Quantidade vendida Produto 1")
View(comp_prices)
comp_price$day <- ymd(comp_prices$DATE_EXTRACTION)
comp_prices$day <- ymd(comp_prices$DATE_EXTRACTION)
?ymd
comp_prices$day <- as.Date(comp_prices$DATE_EXTRACTION)
comp_prices$date <- as.Date(comp_prices$DATE_EXTRACTION)
comp_prices$date <- as.Date(comp_prices$DATE_EXTRACTION)
comp_prices$day <- as.numeric(as.factor(wday(comp_prices$date)))
comp_prices$month <- as.numeric(as.factor(month(comp_prices$date)))
comp_prices$time <- format(comp_prices[,"DATE_EXTRACTION"], "%H:%M:%S")
comp_prices$time <- format(comp_prices$DATE_EXTRACTION, "%H:%M:%S")
?strftime
comp_prices$time <- strftime(comp_prices$DATE_EXTRACTION, "%H:%M:%S")
P1_Price_by_weekday_month <- sales %>%
group_by(month, day, PROD_ID, COMPETITOR, PAY_TYPE) %>%
filter(PROD_ID == "P1") %>%
summarise(AVG_Price = mean(COMPETITOR_PRICE))
P1_Price_by_weekday_month <- comp_prices %>%
group_by(month, day, PROD_ID, COMPETITOR, PAY_TYPE) %>%
filter(PROD_ID == "P1") %>%
summarise(AVG_Price = mean(COMPETITOR_PRICE))
View(P1_Price_by_weekday_month)
View(P1_Price_by_weekday_month)
P1_by_weekday_month <- sales %>%
group_by(month, day, PROD_ID) %>%
filter(PROD_ID == "P1") %>%
summarise(QTY_ORDER = sum(QTY_ORDER),
REVENUE = sum (REVENUE)) %>%
mutate(Price = REVENUE/QTY_ORDER)
View(Price_by_weekday_month)
View(P1_by_weekday_month)
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_PRice, color = COMPETITOR))+
geom_point(size = 3)+
xlab("Mês")+
ylab("Quantidade vendida Produto 1")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price, color = COMPETITOR))+
geom_point(size = 3)+
xlab("Mês")+
ylab("Quantidade vendida Produto 1")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price < 2000, color = COMPETITOR))+
geom_point(size = 3)+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price, color = COMPETITOR))+
geom_point(size = 3)+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = (AVG_Price =< 2000), color = COMPETITOR))+
geom_point(size = 3)+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = (AVG_Price < "2000"), color = COMPETITOR))+
geom_point(size = 3)+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price, color = COMPETITOR))+
geom_point(size = 3)+
xlab("Mês")+
ylab("Price")
P1_Price_by_weekday_month$AVG_Price < 2000
out <- P1_Price_by_weekday_month$AVG_Price < 2000
library(caTools)
P1_Price_by_weekday_month <- subset(P1_Price_by_weekday_month, out ==TRUE)
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price, color = COMPETITOR))+
geom_point(size = 3)+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price, color = COMPETITOR))+
geom_line(size = 3)+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price, color = COMPETITOR))+
geom_line(size = 1)+
xlab("Mês")+
ylab("Price")
View(P1_by_month)
View(P1_by_weekday_month)
P1_Price_by_month <- comp_prices %>%
group_by(month, PROD_ID, COMPETITOR, PAY_TYPE) %>%
filter(PROD_ID == "P1") %>%
summarise(AVG_Price = mean(COMPETITOR_PRICE))
out <- P1_Price_by_weekday_month$AVG_Price < 2000
library(caTools)
P1_Price_by_weekday_month <- subset(P1_Price_by_weekday_month, out ==TRUE)
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price, color = COMPETITOR))+
geom_line(size = 1)+
geom_point(data = )
View(P1_Price_by_month)
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price, color = COMPETITOR))+
geom_line(size = 1)+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price, color = COMPETITOR))+
geom_line(size = 1)+
geom_point(data = P1_by_month, x = month, y = Price)
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price, color = COMPETITOR))+
geom_line(size = 1)+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot()+
geom_line(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price, color = COMPETITOR))+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price))+
geom_line(size = 1)+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price, color = factor(COMPETITOR)))+
geom_line(size = 1)+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price))+
geom_line(aes(color = factor(COMPETITOR), size = 1))+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price))+
geom_line(aes(color = factor(COMPETITOR)))+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price))+
geom_line(aes(color = factor(COMPETITOR), size 0.5))+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price))+
geom_line(aes(color = factor(COMPETITOR)), size 0.5)+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price))+
geom_line(aes(color = factor(COMPETITOR)))+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price))+
geom_line(aes(color = factor(COMPETITOR)), group = PAY_TYPE)+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price))+
geom_line(aes(group = PAY_TYPE, color = factor(COMPETITOR)))+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price, group = PAY_TYPE))+
geom_line(aes(color = factor(COMPETITOR)))+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
P1_Price_by_month <- comp_prices %>%
group_by(month, PROD_ID, COMPETITOR, PAY_TYPE) %>%
filter(PROD_ID == "P1") %>%
summarise(AVG_Price = mean(COMPETITOR_PRICE))
out <- P1_Price_by_month$AVG_Price < 2000
P1_Price_by_month <- subset(P1_Price_by_month, out ==TRUE)
ggplot(P1_Price_by_weekday_month, aes(x = month, y = AVG_Price, group = PAY_TYPE))+
geom_line(aes(color = factor(COMPETITOR)))+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot(P1_Price_by_month, aes(x = month, y = AVG_Price, group = PAY_TYPE))+
geom_line(aes(color = factor(COMPETITOR)))+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot()+
geom_line(data = P1_Price_by_month,
aes(x = month, y = AVG_Price, group = PAY_TYPE,
color = factor(COMPETITOR)))+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot()+
geom_line(data = P1_Price_by_month,
aes(x = month, y = AVG_Price,
color = factor(COMPETITOR)))+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot()+
geom_line(data = P1_Price_by_month,
aes(x = month, y = AVG_Price,
color = factor(COMPETITOR), size = 0.5))+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot()+
geom_line(data = P1_Price_by_month,
aes(x = month, y = AVG_Price,
color = factor(COMPETITOR), size = 0.3))+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot()+
geom_line(data = P1_Price_by_month,
aes(x = month, y = AVG_Price,
color = factor(COMPETITOR)))+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot()+
geom_line(data = P1_Price_by_month,
aes(x = month, y = AVG_Price,
color = factor(COMPETITOR)), size = 2)+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
ggplot()+
geom_line(data = P1_Price_by_month,
aes(x = month, y = AVG_Price,
color = factor(COMPETITOR)), size = 1)+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
P1_Price_by_month_2 <- comp_prices %>%
group_by(month, PROD_ID, COMPETITOR) %>%
filter(PROD_ID == "P1") %>%
summarise(AVG_Price = mean(COMPETITOR_PRICE))
View(P1_Price_by_month_2)
out <- P1_Price_by_month_2$AVG_Price < 2000
P1_Price_by_month_2 <- subset(P1_Price_by_month_2, out ==TRUE)
ggplot()+
geom_line(data = P1_Price_by_month_2,
aes(x = month, y = AVG_Price,
color = factor(COMPETITOR)), size = 1)+
geom_point(data = P1_by_month, aes(x = month, y = Price))+
xlab("Mês")+
ylab("Price")
rownames(P1_Price_by_month)
head(P1_Price_by_month)
temp_P1_1 <- comp_prices %>%
group_by(month, PROD_ID, COMPETITOR, PAY_TYPE) %>%
filter(COMPETITOR == "C1") %>%
filter(PAY_TYPE == "11") %>%
summarise(AVG_Price = mean(COMPETITOR_PRICE))
View(temp_P1_1)
temp_P1_1 <- comp_prices %>%
group_by(month, PROD_ID, COMPETITOR, PAY_TYPE) %>%
filter(COMPETITOR == "C1") %>%
filter(PAY_TYPE == "1") %>%
summarise(AVG_Price = mean(COMPETITOR_PRICE))
temp_P1_1 <- comp_prices %>%
group_by(month, PROD_ID, COMPETITOR, PAY_TYPE) %>%
filter(COMPETITOR == "C1") %>%
filter(PAY_TYPE == "1") %>%
filter(PROD_ID == "P1")
temp_P1_1 <- comp_prices %>%
group_by(month, PROD_ID, COMPETITOR, PAY_TYPE) %>%
filter(COMPETITOR == "C1") %>%
filter(PAY_TYPE == "1") %>%
filter(PROD_ID == "P1") %>%
summarise(AVG_Price = mean(COMPETITOR_PRICE))
for (i in 1:2){
temp_P1_i <- comp_prices %>%
group_by(month, PROD_ID, COMPETITOR, PAY_TYPE) %>%
filter(COMPETITOR == "Ci") %>%
filter(PAY_TYPE == "1") %>%
filter(PROD_ID == "P1") %>%
summarise(AVG_Price = mean(COMPETITOR_PRICE))
}
View(temp_P1_i)
for (i in 1:2){
temp_P1_i <- comp_prices %>%
group_by(month, PROD_ID, COMPETITOR, PAY_TYPE) %>%
filter(COMPETITOR == Ci) %>%
filter(PAY_TYPE == "1") %>%
filter(PROD_ID == "P1") %>%
summarise(AVG_Price = mean(COMPETITOR_PRICE))
}
for (i in 1:2){
temp_P1_i <- comp_prices %>%
group_by(month, PROD_ID, COMPETITOR, PAY_TYPE) %>%
filter(COMPETITOR == "C"i) %>%
filter(PAY_TYPE == "1") %>%
filter(PROD_ID == "P1") %>%
summarise(AVG_Price = mean(COMPETITOR_PRICE))
}
temp_P1_1 <- comp_prices %>%
group_by(month, PROD_ID, COMPETITOR, PAY_TYPE) %>%
filter(COMPETITOR == "C1") %>%
filter(PAY_TYPE == "1") %>%
filter(PROD_ID == "P1") %>%
summarise(AVG_Price = mean(COMPETITOR_PRICE))
?merge
P1_merged <- merge(P1_by_month, temp_P1_1, by = month, all = TRUE)
P1_merged <- merge(P1_by_month, temp_P1_1, by = "month", all = TRUE)
View(P1_merged)
cor(P1_merged$Price, P1_merged$AVG_Price)
P1_merged[is.na(P1_merged)] <- 0
cor(P1_merged$Price, P1_merged$AVG_Price)
